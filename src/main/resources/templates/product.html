<html class="h-100" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>benwon 飯團媽團購批發</title>
<!-- CSS -->
<link rel="stylesheet" href="/css/bootstrap4-toggle.min.css"></link>
<link rel="stylesheet" href="/css/bootstrap.css"></link>
<link rel="stylesheet" href="/css/docs.min.css"></link>
<link rel="stylesheet" href="/css/3.3.7_bootstrap.min.css"></link>
<link rel="stylesheet" href="/css/4.3.1_bootstrap.min.css"></link>
<link rel="stylesheet" href="/css/bootstrap-grid.css"></link>
<link rel="stylesheet" href="/css/bootstrap-grid.min.css"></link>
<link rel="stylesheet" href="/css/bootstrap-reboot.css"></link>
<link rel="stylesheet" href="/css/bootstrap-reboot.min.css"></link>
<link rel="stylesheet" href="/css/bootstrap.css"></link>
<link rel="stylesheet" href="/css/bootstrap.min.css"></link>
<link rel="stylesheet" href="/css/benwon.css"></link>
<!-- CSS -->
<!-- JS -->
<script src="/js/2.0.0/jquery.min.js"></script>
<script src="/js/fontawesome/all.js"></script>
<script src="/js/bootstrap4-toggle.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/2.1.1/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/4.3.1/bootstrap.min.js"></script>
<script src="/js/jquery-3.3.1.slim.min.js"></script>
<script src="/js/3.3.7/bootstrap.min.js"></script>
<script src="/js/2.0.0/jquery.min.js"></script>
<script src="/js/jquery.twzipcode.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery.blockUI/2.70/jquery.blockUI.min.js"></script>

<script type="text/javascript">
	$(function() {
		/* 按下GoTop按鈕時的事件 */
		$('#gotop').click(function() {
			$('html,body').animate({
				scrollTop : 0
			}, 'slow');
			/* 返回到最頂上 */
			return false;
		});

		/* 偵測卷軸滑動時，往下滑超過400px就讓GoTop按鈕出現 */
		$(window).scroll(function() {
			if ($(this).scrollTop() > 200) {
				$('#gotop').fadeIn();
			} else {
				$('#gotop').fadeOut();
			}
		});
	});
</script>
<!-- JS -->


</head>
<body>

	<div id="shopCartContext">
		<!-- web -->
		<!-- 回到最上層 -->
		<div class="visible-md visible-lg">
			<a id="gotop" class="gotop_web" href="/order.html"> <i
				class="fa fa-chevron-circle-up gotop"></i>
			</a>
		</div>
		<!-- 回到最上層 -->

		<!-- 購物車 -->
		<div class="visible-md visible-lg">
			<a id="shop_cart_red" class="shop_cart_web" href="/order.html"
				v-if="shopListSize > 0"></a> <a id="shop_cart" class="shop_cart_web"
				href="/order.html"> <i class="fas fa-shopping-cart shop_cart"></i>
			</a>
		</div>
		<!-- 購物車 -->

		<!-- phone -->
		<!-- 回到最上層 -->
		<div class="hidden-md hidden-lg">
			<a id="gotop" class="gotop_phone" href="#"> <i
				class="fa fa-chevron-circle-up gotop"></i>
			</a>
		</div>
		<!-- 回到最上層 -->


		<!-- 購物車 -->
		<div class="hidden-md hidden-lg">
			<a id="shop_cart_red" class="shop_cart_phone_red" href="/order.html"
				v-if="shopListSize > 0"> </a> <a id="shop_cart"
				class="shop_cart_phone" href="/order.html"> <i
				class="fas fa-shopping-cart shop_cart"></i>
			</a>
		</div>
		<!-- 購物車 -->
	</div>
	<!-- 粉色底 -->
	<div class="container-fluid">

		<div class="row justify-content-center">
			<div id="col-lg-12" class="product_box_bg_800 bg522F35_big">
				<!--商品BOX-標題標題-->
				<tr>
					<div class="carousel-inner text-center product_box_bg_01">
						<a id="backIcon1" class="Back_icon" href="#" onclick="alert('You have clicked the circle.')"> 
							<i id="backIcon2" class="fas fa-times" ></i>
						</a>
						<div class="col-10 col-sm-12 pa0505">
							<h1 class="product_box_pg_title_h1"
								th:text="${product.productName}">Savoursmiths 手工洋芋片</h1>
						</div>
					</div>
				</tr>

				<tr>
					<div class="carousel-inner product_box_bg_02">

						<!-- 商品圖輪播 -->
						<div class="row justify-content-center pa00200">
							<div id="carouselExampleControls"
								class="carousel slide carousel-fade " data-ride="carousel">
								<ol class="carousel-indicators">
									<li data-target="#carouselExampleControls" data-slide-to="0"
										class="active" th:each="item, iterStat : ${product.imageList}"
										th:data-slide-to="${iterStat.index}"
										th:class="${iterStat.index == 0}? 'active'"></li>
								</ol>
								<div class="carousel-inner product_box_bg_600">
									<!-- 商品圖 -->
									<div class="carousel-item"
										th:each="item, iterStat : ${product.imageList}"
										th:class="${iterStat.index == 0} ? 'carousel-item active' : 'carousel-item'">
										<img class="d-block w-100"
											src="images/product_box_pg/test/00.png"
											th:src="${item.resourceUrl}">
									</div>
								</div>
								<a class="carousel-control-prev" href="#carouselExampleControls"
									role="button" data-slide="prev"> <span
									class="carousel-control-prev-icon" aria-hidden="true"></span> <span
									class="sr-only">Previous</span>
								</a> <a class="carousel-control-next"
									href="#carouselExampleControls" role="button" data-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="sr-only">Next</span>
								</a>
							</div>
						</div>
						<!-- 商品圖輪播 -->

						<div id="vue-app" class="row justify-content-center">
							<!-- 訂單明細 -->
							<div class="col-12 pa200200">
								<div class="text-center">
									<div class="">
										<div>
											<ul class="nav nav-tabs" id="ol_tab" role="tab">
												<li class="nav-item">
													<h3 class="nav-link not_s_tbs active" data-toggle="tab"
														href="#ol_tab_1">訂單明細</h3>
												</li>
												<li class="nav-item">
													<h3 class="nav-link not_s_tbs" data-toggle="tab"
														href="#ol_tab_2">規範</h3>
												</li>
											</ul>
										</div>
										<div class="bg522F35">
											<div class="tab-content product_box_pg_content_1 min200">
												<div class="tab-pane fade in show active" id="ol_tab_1">
													<div class="product_box_txt">
														<dl class="row">
															<dt class="col-sm-2">品名：</dt>
															<dd class="col-sm-10" th:text="${product.productName}">
																Savoursmiths 手工洋芋片</dd>
															<dt class="col-sm-2">售價：</dt>
															<dd class="col-sm-10">
																<s
																	th:text="${'$' + #numbers.formatDecimal(product.salePrice, 0, 'COMMA', 0, 'POINT')}">$99,999</s>
															</dd>
															<dt class="col-sm-2">優惠價：</dt>
															<dd class="col-sm-10"
																th:text="${'$' + #numbers.formatDecimal(product.discPrice, 0, 'COMMA', 0, 'POINT')}">
																$9,999</dd>
															<dt class="col-sm-2">訂購單位：</dt>
															<dd class="col-sm-10" th:text="${product.basicUnitDesc}">1包
																/ 1箱(12包)</dd>
															<dt class="col-sm-2">賞味效期：</dt>
															<dd class="col-sm-10" th:text="${product.expiryDate}">
																2020/01/01</dd>
															<dt class="col-sm-2">庫存數量：</dt>
															<dd class="col-sm-10"
																th:text="${product.stockQuantitySum + ' / ' + product.basicUnitDesc}">
																9999/包</dd>
															<dt class="col-sm-2">訂購數量：</dt>
															<dd class="col-sm-10">
																<form>
																	<div class="form-group"
																		v-for="productItem in productItemList">
																		<label>{{ productItem.productItemName }}</label>
																		<div class="input-group">
																			<input type="number" class="form-control"
																				placeholder="請填入數量" v-model="productItem.buyCount"
																				@change="calculate">
																			<div class="input-group-append">
																				<select class="form-control"
																					v-model="productItem.salesUnitselected"
																					@change="calculate">
																					<option
																						v-for="salesUnit in productItem.salesUnitList"
																						:value="salesUnit.code">
																						{{salesUnit.text}}</option>
																				</select>
																			</div>
																		</div>
																	</div>
																</form>
															</dd>
															<dt class="col-sm-2  line_height_30 total_red">訂單總額：</dt>
															<dd class="col-sm-10">
																<form>
																	<div class="input-group mb-3">
																		<span class="input-group-text">$</span> <input
																			type="text" class="form-control" placeholder="99,999"
																			readonly v-model="orderPrice"> <span
																			class="input-group-text">NTD</span>
																	</div>
																</form>
															</dd>
														</dl>
													</div>
												</div>
												<div class="tab-pane fade" id="ol_tab_2">
													<div class="product_box_txt" th:utext="${product.norm}">
														<p>
															Savoursmiths 英國手工洋芋片<br> <br> ◉市場售價：$150/包<br>
															<br> 商品說明：<br> ◉口味：松露迷迭香、和牛佐蜂蜜芥末、帕瑪森起司佐波特酒<br>
															◉重量：150g/包<br> ◉有效日期：2020.01<br> <br>
															◉結單時間：<br> 8/1(四)、*8/7(三)<br> <br> ◉到貨時間：
															<br> 週四下單，隔週的週五前到貨<br> <br> ◉自取地點：<br>
															台北市—天母，新北市—新莊、五股<br> <br> ◉郵寄方式：<br>
															宅配出貨，滿$2,500免運費<br> <br>
														</p>
													</div>
												</div>
											</div>
										</div>
										<div class="pa020020">
											<div class="product_box_bg_button">
												<button type="button"
													class="all_button btn-danger btn-lg btn-block"
													@click="addToCart">
													<h1 class="m-0">確認下訂</h1>
												</button>
											</div>
										</div>

									</div>

								</div>
							</div>
							<!-- 訂單明細 -->

							<!-- 商品資訊 -->
							<div class="col-12 pa200200">
								<div class="text-center">

									<div class="">
										<div>
											<ul class="nav nav-tabs" id="pi_tab" role="tab">
												<li class="nav-item">
													<h3 class="nav-link not_s_tbs active" data-toggle="tab"
														href="#pi_tab_1">商品介紹</h3>
												</li>
												<li class="nav-item">
													<h3 class="nav-link not_s_tbs" data-toggle="tab"
														href="#pi_tab_2">介紹</h3>
												</li>
												<li class="nav-item">
													<h3 class="nav-link not_s_tbs" data-toggle="tab"
														href="#pi_tab_3">規格</h3>
												</li>
											</ul>
										</div>

										<div class="bg522F35">
											<div class="tab-content product_box_pg_content_1 min200">
												<div class="tab-pane fade in show active" id="pi_tab_1">
													<div class="product_box_txt"
														th:utext="${product.productIntroduction}">
														<p>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_01.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_06.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_07.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_08.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_09.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_10.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_11.png"><br>
															<img class="d-block w-100"
																src="images/product_box_pg/test/product_18/product_18_02-05.png"><br>
														</p>
													</div>
												</div>
												<div class="tab-pane fade" id="pi_tab_2">
													<div class="product_box_txt"
														th:utext="${product.introduction}">
														<p>
															【原來洋芋片也可以極致奢華！】英國時尚party唯一指名～倫敦經濟日報報導，洋芋片新革命！<br /> <br />
															✨松露迷迭香<br /> ✨和牛佐蜂蜜芥末<br /> ✨帕瑪森起司佐波特酒<br /> <br />
															上等原料＋最講究的手法＝饗宴等級的洋芋片<br />
															✔️來自英國倫敦🇬🇧✔️以純手工小批量烹製✔️整顆帶皮馬鈴薯製作✔️選用世界各地獨特的奢華美味食材<br />
															<br /> 原料超高級的奢華洋芋片<br /> 👑松露迷迭香口味<br />
															一打開包裝就是濃濃的松露迷迭香氣 撲鼻而來 帶皮的馬鈴薯製成 口感厚脆扎實<br /> <br />
															🥩和牛佐蜂蜜芥末口味<br /> 和牛夢幻般的鮮美肉香，搭配蜂蜜芥末提鮮微嗆的多層次料理，我最愛❤️大推的口味<br />
															<br /> 🧀️帕瑪森起司佐波特酒<br />
															號稱“起司之王”的帕瑪森義大利起司，佐上芳醇的波特酒，微酸扎實的口感讓人難以忘懷<br /> <br />
															🏅榮獲2018英國美食大獎Great Taste一星認證<br />
															🏅知名節目“請問你是哪裡人？”于美人大力推薦<br /> <br />
														</p>
													</div>
												</div>
												<div class="tab-pane fade" id="pi_tab_3">
													<div class="product_box_txt"
														th:utext="${product.specifications}">
														<p>
															成分<br /> <br /> 商品名稱：Savoursmiths 英國手工洋芋片-松露迷迭香 150g<br />
															成分：馬鈴薯、葵花籽油、糖、香菇抽出物、鹽、米榖粉、洋蔥、酵母抽出物、天然香料、,迷迭香、大蒜粉、百里香、檸檬酸、白胡椒、乾燥黑松露粉。<br />
															淨重：150g<br /> 原產地：英國<br /> 有效日期：2020.01 (未開封)<br />
															保存方式：常溫，請置於陰涼乾燥處，避免日光直射<br /> <br /> <br />
															商品名稱：Savoursmiths 英國手工洋芋片-和牛佐蜂蜜芥末 150g<br />
															成分：馬鈴薯、葵花油、洋蔥、乾燥猶加敦蜂蜜、大蒜粉、芥末籽、熟和牛粉(牛肉)、檸檬汁粉末、甜椒、肉桂、八角茴香。<br />
															淨重：150g<br /> 原產地：英國<br /> 有效日期：2020.01 (未開封)<br />
															保存方式：常溫，請置於陰涼乾燥處，避免日光直射<br /> <br /> <br />
															商品名稱：Savoursmiths 英國手工洋芋片-帕瑪森起司佐波特酒 150g<br />
															成分：馬鈴薯、葵花籽油、起司、鹽、酵母抽出物、紅酒醋、奶粉、乳糖、義大利硬起司(牛奶/鹽/凝乳酶)、糖、黑醋栗萃取物、麥芽糊精、酒醋、天然香料、波特酒、馬鈴薯麥芽糊精、白胡椒、檸檬酸、大蒜粉。<br />
															淨重：150g<br /> 原產地：英國<br /> 有效日期：2020.01 (未開封)<br />
															保存方式：常溫，請置於陰涼乾燥處，避免日光直射<br /> <br />
														</p>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
							<!-- 商品資訊 -->
						</div>
					</div>
				</tr>
				<!-- 商品BOX-內容資訊 -->
			</div>
		</div>
	</div>
	<!-- 粉色底 -->
	<div id="question" style="display:none; cursor: default"> 
        <h1>加入購物車成功, 是否繼續購物?</h1> 
        <input type="button" id="yes" value="是" /> 
        <input type="button" id="no" value="否" /> 
	</div> 
	
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"></script>
	<script th:inline="javascript">
		$(function() {			
			$('#yes').click(function() { 
				window.location.href = '/index.html';
	        });
	 
	        $('#no').click(function() { 
	        	window.location.href = '/order.html';
	        });
		});
		
		
		
		/*<![CDATA[*/
		Vue.config.devtools = true;
		Vue.config.debug = true;
		
		var vueShopCart = new Vue({
			el : '#shopCartContext',
			data : {
				shopCart: {},
				shopListSize: 0
			},
			created : function() {
				var localDataShopCart = localStorage .getItem('localDataShopCart');
				if (localDataShopCart != null) {
					var shopCart = JSON.parse(localDataShopCart);
					this.setShopCart(shopCart);
				}
			},
			methods : {
				setShopCart: function(shopCart){
					this.shopListSize = shopCart.shopList.length;
				}
			}
		});

		var vueapp = new Vue(
				{
					el : '#vue-app',
					data : {
						productId : /*[[(${product.id})]]*/'', // 商品ID
						productName : /*[[${product.productName}]]*/'', // 商品名稱
						salePrice : /*[[${product.salePrice}]]*/'0', // 售價
						discPrice : /*[[${product.discPrice}]]*/'0', // 優惠價 
						basicUnitDesc : /*[[${product.basicUnitDesc}]]*/'', // 訂購單位
						expiryDate : /*[[${product.expiryDate}]]*/'', // 賞味效期
						productItemList : /*[(${productItemList})]*/ [], // 品項
						subTotal: 0,
						freightAmount: 0,
						orderPrice : 0,
						shopCart : {
							version : 1,
							showPurchaserUser : true,
							receiverName : '',
							mobilePhone : '',
							county : '',
							district : '',
							zipcode : '',
							receiverAddress : '',
							remark : '',
							orderAmount : 0,
							freightAmount : 0,
							shopList : []
						}
					},
					created : function() {
						var localDataShopCart = localStorage .getItem('localDataShopCart');
						if (localDataShopCart != null) {
							this.shopCart = JSON.parse(localDataShopCart);
						}
					},
					watch : {},
					methods : {
						calculate : function() { // 計算
							var vueData = this;
							var calculateRS = 0;
							vueData.productItemList.forEach(function(element, index) {
										if(element.buyCount < 0){
											element.buyCount = 0;
										}
										calculateRS = calculateRS + (element.buyCount * vueData.discPrice);
									});
							vueData.orderPrice = calculateRS;
						},
						addToCart : function() { // 加入購物車
							var vueData = this;
							var calculateRS = 0; // 計算結果
							vueData.productItemList.forEach(function(productItem, index) { // 頁面上的資訊
										var shopItemId = productItem.productId + '-' + productItem.id; // 商品加品項為購物車品項ID
										if (productItem.buyCount > 0) { // 品項數量不為 0  的
											// 先檢查有沒有存在
											var repeat = vueData.shopCart.shopList.filter(
													function( shopCartItem, index, arr) {
														return shopCartItem.shopItemId === shopItemId;
													});
											if (repeat.length == 0) { // 不存在購物車, 直接加入
												vueData.shopCart.shopList
														.push({
															'shopItemId' : shopItemId, // 購物車物品編號
															'isEnable' : true, // 結帳頁面按鈕使用
															'productId' : vueData.productId, // 商品ID
															'productName' : vueData.productName, // 商品名稱
															'productImgResourceUrl' : productItem.productImgResourceUrl, // 商品主圖檔
															'productItemId' : productItem.id, // 品項ID
															'productItemName' : productItem.productItemName, // 品項名稱
															'discPrice' : vueData.discPrice, // 優惠價
															'expiryDate' : vueData.expiryDate, // 賞味期限
															'buyCount' : parseInt(productItem.buyCount), // 購買數量
															'basicUnitDesc' : vueData.basicUnitDesc, // 訂購單位
															'subTotal' : vueData.discPrice * parseInt(productItem.buyCount) // 優惠價*購買數量
														});
											} else {
												vueData.shopCart.shopList
														.forEach(function( shopCartItem, index) {
															if (shopCartItem.shopItemId == shopItemId) {
																shopCartItem.buyCount = parseInt(shopCartItem.buyCount) + parseInt(productItem.buyCount);
															}
														});
											}
											
										}
									});
							// 計算
							this.calculate();
							
							vueData.clear();
							
							// 通知購物車組件
							vueShopCart.setShopCart(vueData.shopCart);
							// 儲存
							var localDataShopCart = JSON.stringify(vueData.shopCart);
							localStorage.setItem('localDataShopCart', localDataShopCart);
							$.blockUI({ message: $('#question'), css: { width: '400px' } }); 
						},
						clear : function() {
							var vueData = this;
							// 清除
							vueData.productItemList.forEach(function( productItem, index) {
								productItem.buyCount = 0;
							});
							vueData.orderPrice = 0;
						}
					}
				});
		/*]]>*/
	</script>


</body>
</html>
